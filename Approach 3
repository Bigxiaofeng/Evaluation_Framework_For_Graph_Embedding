import warnings
warnings.filterwarnings(action='ignore', category=UserWarning, module='gensim')

from sklearn.svm import LinearSVC
from gensim.models import doc2vec
from collections import namedtuple
from gensim.models.doc2vec import TaggedDocument
from sklearn.metrics import accuracy_score
import numpy as np 
import pandas as pd
from sklearn.model_selection import train_test_split


def run():
    
    
    # Load data
    X = []
    Doc_ID =[]
    docs = []
    label={}
    y =[]

    with open("C:/Users/asus/Documents/GitHub/graph_embeddings/cora/cora.content") as f:

        for line in f.readlines():
            line = line.split()
            label[line[0]] = line[-1]
            words=np.array(line[1:-1])
            tags = line[0]
            occ = np.where(words == '1')
            occ = [str(x) for x in occ[0]]
            docs.append(TaggedDocument(occ, [tags]))
            Doc_ID.append(line[0])  

    # Building the model for Doc2Vec   

    model = doc2vec.Doc2Vec(docs, size = 100, dm = 0,  window = 5 , min_count = 1, workers = 4, iter = 10, negative = 10)       
    # Getting the embeddings 
    for document_id in Doc_ID:
        X.append(model.docvecs[document_id])
        y.append(label[document_id]) 
        
       
    fichier1=open('monfichier.txt','w')
    fichier1.write("Doc2vec Embeddings ")
    fichier1.write(X)
    fichier1.close()



